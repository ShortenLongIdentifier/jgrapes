var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var d=a[Symbol.iterator];return d?d.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var d,c=[];!(d=a.next()).done;)c.push(d.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.checkStringArgs=function(a,d,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill=function(a,d,c,g){if(d){c=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var e=a[g];e in c||(c[e]={});c=c[e]}a=a[a.length-1];g=c[a];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var d=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var e=a.length;0<e&&0<c;)if(d[--c]!=a[--e])return!1;return 0>=e}},"es6","es3");$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var g=a.length,e=0;e<g;e++){var m=a[e];if(d.call(c,m,e,a))return{i:e,v:m}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;for(c=c||0;c<e;c++)if(d[c]==a||Object.is(d[c],a))return!0;return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var d=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=d.length,m=a.length;c=Math.max(0,Math.min(c|0,d.length));for(var n=0;n<m&&c<e;)if(d[c++]!=a[n++])return!1;return n>=m}},"es6","es3");var JGPortal={};
(function(){function a(){var b=(new Date).getTime();window.performance&&"function"===typeof window.performance.now&&(b+=performance.now());return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var f=(b+16*Math.random())%16|0;b=Math.floor(b/16);return("x"==a?f:f&3|8).toString(16)})}function d(b){b=$(".portlet[data-portlet-id='"+b+"']");if(1===b.length)return $(b[0])}function c(){return $(".portlet[data-portlet-id]").map(function(){return $(this).attr("data-portlet-id")}).get()}function g(b){b=
$("#tabs").tabs().find("> div[data-portlet-id='"+b+"']");if(1===b.length)return $(b[0])}function e(){return $("#tabs").tabs().find("> div[data-portlet-id]").map(function(){return $(this).attr("data-portlet-id")}).get()}function m(b){var a=$("#tabs").tabs(),c=void 0;a.find("> div").filter(function(a){return $(this).attr("data-portlet-id")===b?(c=a,!0):!1});c&&a.tabs("option","active",c)}function n(b,a,c){for(var f=0;f<b.length;f++){if(b[f]===a)return!0;if(b[f]===c)break}return!1}function x(b,a,c,r){var f=
d(b);if(!f){f=$('<div class="portlet"><div class="portlet-header"><span class="portlet-header-text"></span></div><div class="portlet-content"></div></div>');f.attr("data-portlet-id",b);f.addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all");var l=f.find(".portlet-header");l.addClass("ui-widget-header ui-corner-all");a.includes("DeleteablePreview")&&(l.prepend("<span class='ui-icon ui-icon-delete portlet-delete'></span>"),l.find(".portlet-delete").on("click",function(){var b=$(this).closest(".portlet").attr("data-portlet-id");
JGPortal.sendDeletePortlet(b)}));a.includes("View")&&(l.prepend("<span class='ui-icon ui-icon-fullscreen portlet-expand'></span>"),l.find(".portlet-expand").on("click",function(){var b=$(this).closest(".portlet").attr("data-portlet-id");g(b)?m(b):JGPortal.sendRenderPortlet(b,"View",!0)}));var e=!1;$(".column").each(function(a){if(a>=t.length)return!1;var c=t[a];if(n(c,b,b))return $(this).find(".portlet").each(function(a){a=$(this);var l=a.attr("data-portlet-id");if(!n(c,l,b))return a.before(f),e=
!0,!1}),e||$(this).append(f),e=!0,!1});e||$(".column").first().prepend(f);p()}a=$(c);f.find(".portlet-header-text").text(a.attr("data-portlet-title"));c=f.find(".portlet-content");c.children().detach();c.append(a);r&&$("#tabs").tabs("option","active",0)}function p(){if(v){var b=[];$(".overview-panel").find(".column").each(function(a){var c=[];b.push(c);$(this).find("div.portlet[data-portlet-id]").each(function(b){c.push($(this).attr("data-portlet-id"))})});var a=[],c=$("#tabs").tabs();c.find(".ui-tabs-nav .ui-tabs-tab").each(function(b){0<
b&&(b=$(this).attr("aria-controls"),b=c.find("#"+b).attr("data-portlet-id"),a.push(b))});JGPortal.sendLayout(b,a)}}var q={debug:function(b){console&&console.debug&&console.debug(b)},info:function(b){console&&console.info&&console.info(b)},warn:function(b){console&&console.warn&&console.warn(b)},error:function(b){console&&console.error&&console.error(b)}};JGPortal.log=q;JGPortal.formatMemorySize=function(b,a,c){void 0===c&&(c=a,a=-1);for(var f=0;1E4<b&&5>f;)b/=1024,f+=1;var d="PiB";switch(f){case 0:d=
"B";break;case 1:d="kiB";break;case 2:d="MiB";break;case 3:d="GiB";break;case 4:d="TiB"}return 0<=a?(new Intl.NumberFormat(c,{minimumFractionDigits:a,maximumFractionDigits:a})).format(b)+" "+d:(new Intl.NumberFormat(c)).format(b)+" "+d};var k=function(){this._ws=null;this._sendQueue=[];this._recvQueue=[];this._recvQueueLocks=0;this._messageHandlers={};this._refreshTimer=null;this._inactivity=0;this._reconnectTimer=null;this._connectRequested=!1;this._portalSessionId=sessionStorage.getItem("org.jgrapes.portal.sessionId");
this._portalSessionId||(this._portalSessionId=a(),sessionStorage.setItem("org.jgrapes.portal.sessionId",this._portalSessionId));this._location=("https:"===window.location.protocol?"wss":"ws")+"://"+window.location.host+window.location.pathname;this._location.endsWith("/")||(this._location+="/");this._location+="portal-session/"+this._portalSessionId;this._connectionLostNotification=null};k.prototype.portalSessionId=function(){return this._portalSessionId};k.prototype._connect=function(){this._ws=
new WebSocket(this._location);var b=this;this._ws.onopen=function(){null!=b._connectionLostNotification&&(b._connectionLostNotification.notification("close"),$("#server-connection-restored-notification").notification({autoClose:2E3}));c().forEach(function(b){JGPortal.sendRenderPortlet(b,"Preview",!1)});e().forEach(function(b){JGPortal.sendRenderPortlet(b,"View",!1)});b._drainSendQueue();b._refreshTimer=setInterval(function(){0==b._sendQueue.length&&(b._inactivity+=JGPortal.portalSessionRefreshInterval,
0<JGPortal.portalSessionInactivityTimeout&&b._inactivity>=JGPortal.portalSessionInactivityTimeout&&(b.close(),$("#portal-session-suspended-dialog").dialog("option","buttons",{Ok:function(){$(this).dialog("close");b.connect()}}),$("#portal-session-suspended-dialog").dialog("open")),b._send({jsonrpc:"2.0",method:"keepAlive",params:[]}))},JGPortal.portalSessionRefreshInterval)};this._ws.onclose=function(a){null!==b._refreshTimer&&(clearInterval(b._refreshTimer),b._refreshTimer=null);b._ws=null;b._connectRequested&&
(null==b._connectionLostNotification?b._connectionLostNotification=$("#server-connection-lost-notification").notification({error:!0,icon:"alert",destroyOnClose:!1}):b._connectionLostNotification.notification("open"),b._initiateReconnect())};this._ws.onerror=function(a){null!==b._refreshTimer&&(clearInterval(b._refreshTimer),b._refreshTimer=null);b._ws=null;b._connectRequested&&b._initiateReconnect()};this._ws.onmessage=function(a){a=JSON.parse(a.data);b._recvQueue.push(a);1===b._recvQueue.length&&
b._handleMessages()}};k.prototype.connect=function(){this._connectRequested=!0;this._connect()};k.prototype.close=function(){this._send({jsonrpc:"2.0",method:"disconnect",params:[this._portalSessionId]});this._connectRequested=!1;this._ws.close()};k.prototype._initiateReconnect=function(){if(!this._reconnectTimer){var b=this;this._reconnectTimer=setTimeout(function(){b._reconnectTimer=null;b._connect()},1E3)}};k.prototype._drainSendQueue=function(){for(;1==this._ws.readyState&&0<this._sendQueue.length;){var b=
this._sendQueue[0];try{this._ws.send(b),this._sendQueue.shift()}catch(f){q.warn(f)}}};k.prototype._send=function(b){this._sendQueue.push(JSON.stringify(b));this._drainSendQueue()};k.prototype.send=function(b){this._inactivity=0;this._send(b)};k.prototype.addMessageHandler=function(b,a){this._messageHandlers[b]=a};k.prototype._handleMessages=function(){for(;!(0===this._recvQueue.length||0<this._recvQueueLocks);){var b=this._recvQueue.shift(),a=this._messageHandlers[b.method];a?b.hasOwnProperty("params")?
a.apply(null,[].concat($jscomp.arrayFromIterable(b.params))):a():q.error("No handler for invoked method "+b.method)}};k.prototype.lockMessageReceiver=function(){this._recvQueueLocks+=1};k.prototype.unlockMessageReceiver=function(){--this._recvQueueLocks;0==this._recvQueueLocks&&this._handleMessages()};var h=new k;JGPortal.lockMessageQueue=function(){h.lockMessageReceiver()};JGPortal.unlockMessageQueue=function(){h.unlockMessageReceiver()};var t=[[],[],[]],v=!1,u={};h.addMessageHandler("lastPortalLayout",
function(b,a){t=b});h.addMessageHandler("reload",function(){window.location.reload(!0)});JGPortal.registerPortletMethod=function(b,a,c){var d=u[b];d||(d={},u[b]=d);d[a]=c};h.addMessageHandler("invokePortletMethod",function(b,a,c,d){(b=u[b])&&(c=b[c])&&c(a,d)});h.addMessageHandler("portalConfigured",function(){v=!0;p();$("body").faLoading("remove")});h.addMessageHandler("addPortletType",function(b,a,c,d,e){for(var f in c)e=c[f],0===$("head > link[href='"+e+"']").length&&$("head link[href$='/portal.css']:last").after("<link rel='stylesheet' href='"+
e+"'>");for(var l in d)c=d[l],0===$("head > script[src='"+c+"']").length&&(f=document.createElement("script"),f.src=c,JGPortal.lockMessageQueue(),f.addEventListener("load",function(){JGPortal.unlockMessageQueue()}),$("head").get()[0].appendChild(f));b=$('<li class="ui-menu-item"><div class="ui-menu-item-wrapper" data-portlet-type="'+b+'">'+a+"</div></li>");$("#addon-menu-list").append(b)});JGPortal.findPortletPreview=d;JGPortal.findPortletView=g;JGPortal.layoutChanged=p;var w=1;h.addMessageHandler("updatePortlet",
function(b,a,c,d,e){if("Preview"===a||"DeleteablePreview"===a)x(b,c,d,e);else if("View"===a){c=g(b);d=$(d);if(c)c.children().detach(),c.append(d);else{a=$("#tabs").tabs();w+=1;c="tabs-"+w;var f=$("<li><a href='@{href}'>@{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>".replace(/@\{href\}/g,"#"+c).replace(/@\{label\}/g,d.attr("data-portlet-title")));a.find(".ui-tabs-nav").append(f);c=$("<div id='"+c+"'></div>");c.append(d);c.attr("data-portlet-id",b);a.append(c);
a.tabs("refresh");p()}e&&m(b)}});h.addMessageHandler("deletePortlet",function(a){var b=g(a);b&&(b=b.closest(".ui-tabs-panel").remove().attr("id"),$("#tabs").tabs().find("li[aria-controls='"+b+"']").remove(),$("#tabs").tabs().tabs("refresh"));(a=d(a))&&a.remove();p()});h.addMessageHandler("retrieveLocalData",function(a){var b=[];try{for(var c=0;c<localStorage.length;c++){var d=localStorage.key(c);if(!a.endsWith("/")){if(d!==a)continue}else if(!d.startsWith(a))continue;var e=localStorage.getItem(d);
b.push([d,e])}}catch(y){q.error(y)}JGPortal.sendLocalData(b)});h.addMessageHandler("storeLocalData",function(a){try{for(var b in a){var c=a[b];"u"===c[0]?localStorage.setItem(c[1],c[2]):"d"===c[0]&&localStorage.removeItem(c[1])}}catch(r){q.error(r)}});h.addMessageHandler("createNotification",function(a,c){$(a).notification(c)});h.connect();JGPortal.sendPortalReady=function(){h.send({jsonrpc:"2.0",method:"portalReady"})};JGPortal.sendSetTheme=function(a){h.send({jsonrpc:"2.0",method:"setTheme",params:[a]})};
JGPortal.sendSetLocale=function(a){h.send({jsonrpc:"2.0",method:"setLocale",params:[a]})};JGPortal.sendRenderPortlet=function(a,c,d){h.send({jsonrpc:"2.0",method:"renderPortlet",params:[a,c,d]})};JGPortal.sendAddPortlet=function(a){h.send({jsonrpc:"2.0",method:"addPortlet",params:[a,"Preview"]})};JGPortal.sendDeletePortlet=function(a){h.send({jsonrpc:"2.0",method:"deletePortlet",params:[a]})};JGPortal.sendToPortlet=function(a,c,d){void 0===d?h.send({jsonrpc:"2.0",method:"sendToPortlet",params:[a,
c]}):h.send({jsonrpc:"2.0",method:"sendToPortlet",params:[a,c,d]})};JGPortal.sendLayout=function(a,c){h.send({jsonrpc:"2.0",method:"portalLayout",params:[a,c]})};JGPortal.sendLocalData=function(a){h.send({jsonrpc:"2.0",method:"retrievedLocalData",params:[a]})}})();
(function(){JGPortal.tooltip=function(a){a.tooltip({items:"[data-tooltip-id], [title]",content:function(){var a=$(this);if(a.is("[data-tooltip-id]")){a=a.attr("data-tooltip-id");var c=$("#"+a);return c?(c=c.clone(!0),c.removeClass("jgrapes-tooltip-prototype"),c):"<#"+a+">"}if(a.is("[title]"))return a.attr("title")}})}})();
(function(){var a=null,d=0;$(function(){var c=$("<div></div>");a=$("<div class='ui-notification-container ui-front'></div>");c.append(a);$("body").prepend(c)});$.widget("ui.notification",{options:{classes:{"ui-notification":"ui-corner-all ui-widget-shadow","ui-notification-content":"ui-corner-all"},error:!1,icon:"circle-info",autoOpen:!0,autoClose:null,destroyOnClose:null,show:{effect:"blind",direction:"up",duration:"fast"},hide:{effect:"blind",direction:"up",duration:"fast"}},_create:function(){var a=
this;this._isOpen=!1;null===this.options.destroyOnClose&&(this.options.destroyOnClose=this.options.autoOpen);var g=$("<div></div>"),e="ui-notification-"+ ++d;g.attr("id",e);this._addClass(g,"ui-notification");g.addClass("ui-widget-content");g.addClass("ui-widget");this.options.error?g.addClass("ui-state-error"):g.addClass("ui-state-highlight");e=$("<button></button>");e.addClass("ui-notification-close");e.button({icon:"ui-icon-close",showLabel:!1});e.on("click",function(){a.close()});g.append(e);
this.options.icon&&g.append($('<span class="ui-notification-content ui-icon ui-icon-'+this.options.icon+'"></span>'));e=$("<div></div>");this._addClass(e,"ui-notification-content");g.append(e);e.append(this.element.clone());e.find(":first-child").show();g.hide();this.options.autoClose&&setInterval(function(){a.close()},this.options.autoClose);this.notification=g;this.options.autoOpen&&this.open()},open:function(){a.prepend(this.widget());this._isOpen=!0;this._show(this.widget(),this.options.show)},
widget:function(){return this.notification},close:function(){var a=this;this._isOpen=!1;this._hide(this.widget(),this.options.hide,function(){a.options.destroyOnClose&&a.destroy()})},_destroy:function(){this._isOpen&&this.close()}})})();
