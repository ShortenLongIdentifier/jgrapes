var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var c,b=[];!(c=a.next()).done;)b.push(c.value);return b};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var l=a.length,g=0;g<l;g++){var n=a[g];if(c.call(b,n,g,a))return{i:g,v:n}}return{i:-1,v:void 0}};$jscomp.polyfill=function(a,c,b,l){if(c){b=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var g=a[l];g in b||(b[g]={});b=b[g]}a=a[a.length-1];l=b[a];c=c(l);c!=l&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,b){var c=this;c instanceof String&&(c=String(c));var g=c.length;for(b=b||0;b<g;b++)if(c[b]==a||Object.is(c[b],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,b){var c=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var g=a.length;0<g&&0<b;)if(c[--b]!=a[--g])return!1;return 0>=g}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,b){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var g=c.length,n=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var m=0;m<n&&b<g;)if(c[b++]!=a[m++])return!1;return m>=n}},"es6","es3");var JGPortal={};
(function(){function a(){var e=(new Date).getTime();window.performance&&"function"===typeof window.performance.now&&(e+=performance.now());return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var d=(e+16*Math.random())%16|0;e=Math.floor(e/16);return("x"==a?d:d&3|8).toString(16)})}function c(e){e=$(".portlet[data-portlet-id='"+e+"']");if(1===e.length)return $(e[0])}function b(e){e=$("#tabs").tabs().find("> div[data-portlet-id='"+e+"']");if(1===e.length)return $(e[0])}function l(e){var a=
$("#tabs").tabs(),h=void 0;a.find("> div").filter(function(a){return $(this).attr("data-portlet-id")===e?(h=a,!0):!1});h&&a.tabs("option","active",h)}function g(e,a,h){for(var d=0;d<e.length;d++){if(e[d]===a)return!0;if(e[d]===h)break}return!1}function n(e,a,h,q){var d=c(e);if(!d){d=$('<div class="portlet"><div class="portlet-header"><span class="portlet-header-text"></span></div><div class="portlet-content"></div></div>');d.attr("data-portlet-id",e);d.addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all");
var f=d.find(".portlet-header");f.addClass("ui-widget-header ui-corner-all");a.includes("DeleteablePreview")&&(f.prepend("<span class='ui-icon ui-icon-delete portlet-delete'></span>"),f.find(".portlet-delete").on("click",function(){var a=$(this).closest(".portlet").attr("data-portlet-id");JGPortal.sendDeletePortlet(a)}));a.includes("View")&&(f.prepend("<span class='ui-icon ui-icon-fullscreen portlet-expand'></span>"),f.find(".portlet-expand").on("click",function(){var a=$(this).closest(".portlet").attr("data-portlet-id");
b(a)?l(a):JGPortal.sendRenderPortlet(a,"View",!0)}));var k=!1;$(".column").each(function(a){if(a>=r.length)return!1;var h=r[a];if(g(h,e,e))return $(this).find(".portlet").each(function(a){a=$(this);var b=a.attr("data-portlet-id");if(!g(h,b,e))return a.before(d),k=!0,!1}),k||$(this).append(d),k=!0,!1});k||$(".column").first().prepend(d);m()}a=$(h);d.find(".portlet-header-text").text(a.attr("data-portlet-title"));h=d.find(".portlet-content");h.children().detach();h.append(a);q&&$("#tabs").tabs("option",
"active",0)}function m(){if(u){var a=[];$(".overview-panel").find(".column").each(function(e){var d=[];a.push(d);$(this).find("div.portlet[data-portlet-id]").each(function(a){d.push($(this).attr("data-portlet-id"))})});var d=[],h=$("#tabs").tabs();h.find(".ui-tabs-nav .ui-tabs-tab").each(function(a){0<a&&(a=$(this).attr("aria-controls"),a=h.find("#"+a).attr("data-portlet-id"),d.push(a))});JGPortal.sendLayout(a,d)}}var p={debug:function(a){console&&console.debug&&console.debug(a)},info:function(a){console&&
console.info&&console.info(a)},warn:function(a){console&&console.warn&&console.warn(a)},error:function(a){console&&console.error&&console.error(a)}};JGPortal.log=p;JGPortal.formatMemorySize=function(a,d,h){void 0===h&&(h=d,d=-1);for(var e=0;1E4<a&&5>e;)a/=1024,e+=1;var b="PiB";switch(e){case 0:b="B";break;case 1:b="kiB";break;case 2:b="MiB";break;case 3:b="GiB";break;case 4:b="TiB"}return 0<=d?(new Intl.NumberFormat(h,{minimumFractionDigits:d,maximumFractionDigits:d})).format(a)+" "+b:(new Intl.NumberFormat(h)).format(a)+
" "+b};var k=function(e){this._location=e;this._sendQueue=[];this._recvQueue=[];this._recvQueueLocks=0;this._messageHandlers={};this._timeout=null;this._portalSessionId=sessionStorage.getItem("org.jgrapes.portal.sessionId");this._portalSessionId||(this._portalSessionId=a(),sessionStorage.setItem("org.jgrapes.portal.sessionId",this._portalSessionId))};k.prototype.portalSessionId=function(){return this._portalSessionId};k.prototype._connect=function(){this._ws=new WebSocket(this._location);if(3===this._ws.readyState)this._initiateReconnect();
else{var a=null,d=this;this._ws.onopen=function(){d._ws.send(JSON.stringify({jsonrpc:"2.0",method:"connect",params:[d._portalSessionId]}));d._drainSendQueue();a=setInterval(function(){d.send({jsonrpc:"2.0",method:"keepAlive",params:[]})},JGPortal.portalSessionRefreshInterval)};this._ws.onclose=function(e){clearInterval(a);d._initiateReconnect()};this._ws.onerror=function(a){d._initiateReconnect()};this._ws.onmessage=function(a){a=JSON.parse(a.data);d._recvQueue.push(a);1===d._recvQueue.length&&d._handleMessages()}}};
k.prototype.connect=function(){this._connect()};k.prototype.close=function(){this.send({jsonrpc:"2.0",method:"disconnect",params:[this._portalSessionId]});this._ws.close()};k.prototype._initiateReconnect=function(){if(!this._timeout){var a=this;this._timeout=setTimeout(function(){a._timeout=null;a._connect()})}};k.prototype._drainSendQueue=function(){for(;1==this._ws.readyState&&0<this._sendQueue.length;){var a=this._sendQueue[0];try{this._ws.send(a),this._sendQueue.shift()}catch(d){p.warn(d)}}};
k.prototype.send=function(a){this._sendQueue.push(JSON.stringify(a));this._drainSendQueue()};k.prototype.addMessageHandler=function(a,d){this._messageHandlers[a]=d};k.prototype._handleMessages=function(){for(;!(0===this._recvQueue.length||0<this._recvQueueLocks);){var a=this._recvQueue.shift(),d=this._messageHandlers[a.method];d?a.hasOwnProperty("params")?d.apply(null,[].concat($jscomp.arrayFromIterable(a.params))):d():p.error("No handler for invoked method "+a.method)}};k.prototype.lockMessageReceiver=
function(){this._recvQueueLocks+=1};k.prototype.unlockMessageReceiver=function(){--this._recvQueueLocks;0==this._recvQueueLocks&&this._handleMessages()};var f=new k(("https:"===window.location.protocol?"wss:":"ws")+"//"+window.location.host+window.location.pathname);JGPortal.lockMessageQueue=function(){f.lockMessageReceiver()};JGPortal.unlockMessageQueue=function(){f.unlockMessageReceiver()};var r=[[],[],[]],u=!1,t={};f.addMessageHandler("lastPortalLayout",function(a,d){r=a});f.addMessageHandler("reload",
function(){window.location.reload(!0)});JGPortal.registerPortletMethod=function(a,d,b){var e=t[a];e||(e={},t[a]=e);e[d]=b};f.addMessageHandler("invokePortletMethod",function(a,d,b,c){(a=t[a])&&(b=a[b])&&b(d,c)});f.addMessageHandler("portalConfigured",function(){u=!0;m();$("body").faLoading("remove")});f.addMessageHandler("addPortletType",function(a,d,b,c,f){for(var e in b)f=b[e],0===$("head > link[href='"+f+"']").length&&$("head link[href$='/portal.css']:last").after("<link rel='stylesheet' href='"+
f+"'>");for(var h in c)b=c[h],0===$("head > script[src='"+b+"']").length&&(e=document.createElement("script"),e.src=b,JGPortal.lockMessageQueue(),e.addEventListener("load",function(){JGPortal.unlockMessageQueue()}),$("head").get()[0].appendChild(e));a=$('<li class="ui-menu-item"><div class="ui-menu-item-wrapper" data-portlet-type="'+a+'">'+d+"</div></li>");$("#addon-menu-list").append(a)});JGPortal.findPortletPreview=c;JGPortal.findPortletView=b;JGPortal.layoutChanged=m;var v=1;f.addMessageHandler("updatePortlet",
function(a,d,c,f,g){if("Preview"===d||"DeleteablePreview"===d)n(a,c,f,g);else if("View"===d){c=b(a);f=$(f);if(c)c.children().detach(),c.append(f);else{d=$("#tabs").tabs();v+=1;c="tabs-"+v;var e=$("<li><a href='@{href}'>@{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>".replace(/@\{href\}/g,"#"+c).replace(/@\{label\}/g,f.attr("data-portlet-title")));d.find(".ui-tabs-nav").append(e);c=$("<div id='"+c+"'></div>");c.append(f);c.attr("data-portlet-id",a);d.append(c);
d.tabs("refresh");m()}g&&l(a)}});f.addMessageHandler("deletePortlet",function(a){var d=b(a);d&&(d=d.closest(".ui-tabs-panel").remove().attr("id"),$("#tabs").tabs().find("li[aria-controls='"+d+"']").remove(),$("#tabs").tabs().tabs("refresh"));(a=c(a))&&a.remove();m()});f.addMessageHandler("retrieveLocalData",function(a){var d=[];try{for(var b=0;b<localStorage.length;b++){var c=localStorage.key(b);if(!a.endsWith("/")){if(c!==a)continue}else if(!c.startsWith(a))continue;var e=localStorage.getItem(c);
d.push([c,e])}}catch(w){p.error(w)}JGPortal.sendLocalData(d)});f.addMessageHandler("storeLocalData",function(a){try{for(var b in a){var c=a[b];"u"===c[0]?localStorage.setItem(c[1],c[2]):"d"===c[0]&&localStorage.removeItem(c[1])}}catch(q){p.error(q)}});f.connect();$(window).on("unload",function(){f.close()});JGPortal.sendPortalReady=function(){f.send({jsonrpc:"2.0",method:"portalReady"})};JGPortal.sendSetTheme=function(a){f.send({jsonrpc:"2.0",method:"setTheme",params:[a]})};JGPortal.sendSetLocale=
function(a){f.send({jsonrpc:"2.0",method:"setLocale",params:[a]})};JGPortal.sendRenderPortlet=function(a,b,c){f.send({jsonrpc:"2.0",method:"renderPortlet",params:[a,b,c]})};JGPortal.sendAddPortlet=function(a){f.send({jsonrpc:"2.0",method:"addPortlet",params:[a,"Preview"]})};JGPortal.sendDeletePortlet=function(a){f.send({jsonrpc:"2.0",method:"deletePortlet",params:[a]})};JGPortal.sendToPortlet=function(a,b,c){void 0===c?f.send({jsonrpc:"2.0",method:"sendToPortlet",params:[a,b]}):f.send({jsonrpc:"2.0",
method:"sendToPortlet",params:[a,b,c]})};JGPortal.sendLayout=function(a,b){f.send({jsonrpc:"2.0",method:"portalLayout",params:[a,b]})};JGPortal.sendLocalData=function(a){f.send({jsonrpc:"2.0",method:"retrievedLocalData",params:[a]})}})();
(function(){JGPortal.tooltip=function(a){a.tooltip({items:"[data-tooltip-id], [title]",content:function(){var a=$(this);if(a.is("[data-tooltip-id]")){a=a.attr("data-tooltip-id");var b=$("#"+a);return b?(b=b.clone(!0),b.removeClass("jgrapes-tooltip-prototype"),b):"<#"+a+">"}if(a.is("[title]"))return a.attr("title")}})}})();
